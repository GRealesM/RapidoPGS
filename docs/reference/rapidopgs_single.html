<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute PGS from GWAS summary statistics using posteriors from Wakefield's approximate Bayes Factors — rapidopgs_single • RápidoPGS</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute PGS from GWAS summary statistics using posteriors from Wakefield's approximate Bayes Factors — rapidopgs_single" />
<meta property="og:description" content="'rapidopgs_single computes PGS from a from GWAS summary statistics using posteriors from Wakefield's approximate Bayes Factors" />
<meta property="og:image" content="http://GRealesM.github.io/RapidoPGS/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RápidoPGS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Computing_RapidoPGS.html">Computing a PGS using RápidoPGS-single and GWAS catalog</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/GRealesM/RapidoPGS">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute PGS from GWAS summary statistics using posteriors from Wakefield's approximate Bayes Factors</h1>
    <small class="dont-index">Source: <a href='https://github.com/GRealesM/RapidoPGSR/rapfunc.R'><code>R/rapfunc.R</code></a></small>
    <div class="hidden name"><code>rapidopgs_single.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>'<code>rapidopgs_single</code> computes PGS from a from GWAS summary statistics using posteriors from Wakefield's approximate Bayes Factors</p>
    </div>

    <pre class="usage"><span class='fu'>rapidopgs_single</span><span class='op'>(</span>
  <span class='va'>data</span>,
  N <span class='op'>=</span> <span class='cn'>NULL</span>,
  trait <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cc"</span>, <span class='st'>"quant"</span><span class='op'>)</span>,
  build <span class='op'>=</span> <span class='st'>"hg19"</span>,
  pi_i <span class='op'>=</span> <span class='fl'>1e-04</span>,
  sd.prior <span class='op'>=</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>trait</span> <span class='op'>==</span> <span class='st'>"quant"</span><span class='op'>)</span> <span class='op'>{</span>     <span class='fl'>0.15</span> <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>     <span class='fl'>0.2</span> <span class='op'>}</span>,
  filt_threshold <span class='op'>=</span> <span class='cn'>NULL</span>,
  recalc <span class='op'>=</span> <span class='cn'>TRUE</span>,
  reference <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a data.table containing GWAS summary statistic dataset
with all required information.</p></td>
    </tr>
    <tr>
      <th>N</th>
      <td><p>a scalar representing the sample in the study, or a string indicating
the column name containing it. Required for quantitative traits only.</p></td>
    </tr>
    <tr>
      <th>trait</th>
      <td><p>a string specifying if the dataset corresponds to a case-control
("cc") or a quantitative trait ("quant") GWAS. If trait = "quant", an
ALT_FREQ column is required.</p></td>
    </tr>
    <tr>
      <th>build</th>
      <td><p>a string containing the genome build of the dataset,
either "hg19" (for hg19/GRCh37) or "hg38" (hg38/GRCh38). DEFAULT
"hg19".</p></td>
    </tr>
    <tr>
      <th>pi_i</th>
      <td><p>a scalar representing the prior probability (DEFAULT:
\(1 \times 10^{-4}\)).</p></td>
    </tr>
    <tr>
      <th>sd.prior</th>
      <td><p>the prior specifies that BETA at causal SNPs
follows a centred normal distribution with standard deviation
sd.prior. Sensible and widely used DEFAULTs are 0.2 for case
control traits, and 0.15 * var(trait) for quantitative (selected
if trait == "quant").</p></td>
    </tr>
    <tr>
      <th>filt_threshold</th>
      <td><p>a scalar indicating the ppi threshold (if
<code>filt_threshold</code> &lt; 1) or the number of top SNPs by absolute
weights (if <code>filt_threshold</code> &gt;= 1) to filter the dataset
after PGS computation. If NULL (DEFAULT), no thresholding will
be applied.</p></td>
    </tr>
    <tr>
      <th>recalc</th>
      <td><p>a logical indicating if weights should be
recalculated after thresholding. Only relevant if <code>filt_threshold</code>
is defined.</p></td>
    </tr>
    <tr>
      <th>reference</th>
      <td><p>a string indicating the path of the reference file
SNPs should be filtered and aligned to, see Details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a data.table containing the formatted sumstats dataset with
computed PGS weights.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function will take a GWAS summary statistic dataset as an input,
will assign align it to a reference panel file (if provided), then it will assign
SNPs to LD blocks and compute Wakefield's ppi by LD block, then will use it
to generate PGS weights by multiplying those posteriors by effect sizes (\(\beta\)).
Optionally, it will filter SNPs by a custom filter on ppi and then recalculate weights, to improve accuracy.</p>
<p>Alternatively, if filt_threshold is larger than one, RápidoPGS will select the top
<code>filt_threshold</code> SNPs by absolute weights (note, not ppi but weights).</p>
<p>The GWAS summary statistics file to compute PGS using our method must contain the following minimum columns, with these exact column names:</p><dl>
<dt>CHR</dt><dd><p>Chromosome</p></dd>
<dt>BP</dt><dd><p>Base position (in GRCh37/hg19 or GRCh38/hg38). If using hg38, use build = "hg38" in parameters</p></dd>
<dt>REF</dt><dd><p>Reference, or non-effect allele</p></dd>
<dt>ALT</dt><dd><p>Alternative, or effect allele, the one \(\beta\) refers to</p></dd>
<dt>ALT_FREQ</dt><dd><p>Minor/ALT allele frequency in the tested population, or in a close population from a reference panel. Required for Quantitative traits only</p></dd>
<dt>BETA</dt><dd><p>\(\beta\) (or log(OR)), or effect sizes</p></dd>
<dt>SE</dt><dd><p>standard error of \(\beta\)</p></dd>

</dl>

<p>If a reference is provided,  it should have 5 columns: CHR, BP,
SNPID, REF, and ALT. Also, it should be in the same build as
the summary statistics. In both files, column order does not matter.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Guillermo Reales, Chris Wallace</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>sumstats</span> <span class='op'>&lt;-</span> <span class='fu'>data.table</span><span class='op'>(</span>SNPID<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"rs139096444"</span>,<span class='st'>"rs3843766"</span>,<span class='st'>"rs61977545"</span>, <span class='st'>"rs544733737"</span>,
    <span class='st'>"rs2177641"</span>, <span class='st'>"rs183491817"</span>, <span class='st'>"rs72995775"</span>,<span class='st'>"rs78598863"</span>, <span class='st'>"rs1411315"</span><span class='op'>)</span>, 
    CHR<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"4"</span>,<span class='st'>"20"</span>,<span class='st'>"14"</span>,<span class='st'>"2"</span>,<span class='st'>"4"</span>,<span class='st'>"6"</span>,<span class='st'>"6"</span>,<span class='st'>"21"</span>,<span class='st'>"13"</span><span class='op'>)</span>, 
    BP<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1479959</span>, <span class='fl'>13000913</span>, <span class='fl'>29107209</span>, <span class='fl'>203573414</span>, <span class='fl'>57331393</span>, <span class='fl'>11003529</span>, <span class='fl'>149256398</span>, 
        <span class='fl'>25630085</span>, <span class='fl'>79166661</span><span class='op'>)</span>, 
    REF<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"C"</span>,<span class='st'>"C"</span>,<span class='st'>"C"</span>,<span class='st'>"T"</span>,<span class='st'>"G"</span>,<span class='st'>"C"</span>,<span class='st'>"C"</span>,<span class='st'>"G"</span>,<span class='st'>"T"</span><span class='op'>)</span>, 
    ALT<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A"</span>,<span class='st'>"T"</span>,<span class='st'>"T"</span>,<span class='st'>"A"</span>,<span class='st'>"A"</span>,<span class='st'>"A"</span>,<span class='st'>"T"</span>,<span class='st'>"A"</span>,<span class='st'>"C"</span><span class='op'>)</span>, 
    BETA<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.012</span>,<span class='fl'>0.0079</span>,<span class='fl'>0.0224</span>,<span class='fl'>0.0033</span>,<span class='fl'>0.0153</span>,<span class='fl'>0.058</span>,<span class='fl'>0.0742</span>,<span class='fl'>0.001</span>,<span class='op'>-</span><span class='fl'>0.0131</span><span class='op'>)</span>,
    SE<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.0099</span>,<span class='fl'>0.0066</span>,<span class='fl'>0.0203</span>,<span class='fl'>0.0171</span>,<span class='fl'>0.0063</span>,<span class='fl'>0.0255</span>,<span class='fl'>0.043</span>,<span class='fl'>0.0188</span>,<span class='fl'>0.0074</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>PGS</span>  <span class='op'>&lt;-</span> <span class='fu'>rapidopgs_single</span><span class='op'>(</span><span class='va'>sumstats</span>,  trait <span class='op'>=</span> <span class='st'>"cc"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Assigning LD blocks...</span></div><div class='output co'>#&gt; <span class='message'>Done!</span></div><div class='output co'>#&gt; <span class='message'>Computing a RápidoPGS-single model for a case-control dataset...</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Guillermo Reales, Chris Wallace.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


